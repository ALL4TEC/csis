# frozen_string_literal: true

require 'test_helper'

class PentestReportsControllerTest < ActionDispatch::IntegrationTest
  include Devise::Test::IntegrationHelpers

  test 'unauthenticated cannot list report pentest aggregates' do
    get report_aggregates_path(PentestReport.first)
    check_not_authenticated
  end

  test 'authenticated staff can list report pentest aggregates' do
    sign_in users(:staffuser)
    get report_aggregates_path(PentestReport.first)
    assert_response :success
  end
end
