# frozen_string_literal: true

require 'test_helper'

class VulnerabilityTest < ActiveSupport::TestCase
  test 'valid qid' do
    vuln = Vulnerability.first
    vuln.qid = 'A12'
    assert vuln.valid?
  end

  test 'valid qid 2' do
    vuln = Vulnerability.first
    vuln.qid = '1212'
    assert vuln.valid?
  end

  test 'no qid' do
    vuln = Vulnerability.first
    vuln.qid = nil
    assert_not vuln.valid?
  end

  test 'no title' do
    vuln = Vulnerability.first
    vuln.title = nil
    assert_not vuln.valid?
  end

  test 'no category' do
    vuln = Vulnerability.first
    vuln.category = nil
    assert_not vuln.valid?
  end

  test 'no modified' do
    vuln = Vulnerability.first
    vuln.modified = nil
    assert_not vuln.valid?
  end

  test 'no published' do
    vuln = Vulnerability.first
    vuln.published = nil
    assert_not vuln.valid?
  end
end
