# frozen_string_literal: true

class Exploit < ApplicationRecord
  has_paper_trail

  belongs_to :exploit_source,
    class_name: 'ExploitSource',
    primary_key: :id,
    inverse_of: :exploits

  has_many :exploit_vulnerabilities,
    class_name: 'ExploitVulnerability',
    inverse_of: :exploit,
    dependent: :nullify

  has_many :vulnerabilities,
    class_name: 'Vulnerability',
    inverse_of: :exploits,
    foreign_key: :vulnerability_id,
    through: :exploit_vulnerabilities
end
