# frozen_string_literal: true

# = PentestReport
#
# Le modèle PentestReport correspond à un rapport de type pentest

class PentestReport < Report
  has_one :ext,
    class_name: 'PentestReportExt',
    inverse_of: :report,
    primary_key: :id,
    dependent: :destroy,
    autosave: true

  delegate :tools, :tools=, to: :lazily_built_ext
  delegate :exec_cond, :exec_cond=, to: :lazily_built_ext
  delegate :results, :results=, to: :lazily_built_ext

  private

  def lazily_built_ext
    ext || build_ext
  end
end
