<% if aggregate.references.present? %>
<div class="row">
  <% aggregate.references.each do |ref| %>
    <div class="col-md-2"><%= ref.top.name %></div>
    <div class="col-md-10"><%= ref.name %></div>
  <% end %>
</div>
<% end %>

<%- if aggregate.contents.present? %>
  <%- data = aggregate.contents %>
  <% content_for :sub_header, '', flush: true %>
  <% content_for :sub_body, flush: true do %>
    <div class="table-responsive">
      <table class="table table-hover">
        <caption>Aggregate contents</caption>
        <thead>
          <tr>
            <th id='aggregate-contents-text' class='col-6'><%= t('contents.labels.text') %></th>
            <th id='aggregate-contents-image' class='col-5'><%= t('contents.labels.image') %></th>
          </tr>
        </thead>
        <tbody>
        <%- aggregate.contents.order(:rank).each do |content| %>
          <tr>
            <td headers='aggregate-contents-text'><%= content.text %></td>
            <td headers='aggregate-contents-image'>
              <% if content.image.attached? %>
                <%= image_tag(content.image.variant(:thumb)) %>
              <% else %>
                <i aria-hidden='true' class="material-icons i_scale" alt="no thumbnail"><%= Icons::MAT[:cloud_off] %></i>
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  <%= render 'aggregates/aggregate_sub_bloc', id: 'contents', title: t('aggregates.labels.contents'), aggregate: aggregate, count: data.count %>
<% end %>
