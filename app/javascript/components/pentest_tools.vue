<template>
  <div id='managing_tools'>
    <fieldset>
      <legend class="col-form-label pt-0">{{ i18n.tools.category }}</legend>
    </fieldset>
    <div class="table-responsive">
      <table class="table table-hover">
        <caption>Managing tools</caption>
        <thead>
          <tr>
            <th id='managing-tools-name' class='w-50'>{{ i18n.tools.name }}</th>
            <th id='managing-tools-version' class='w-50'>{{ i18n.tools.version }}</th>
            <th id='managing-tools-btn' class='col-1'><button type='button' class='btn btn-sm btn-primary' v-on:click='addTool'><i aria-hidden='true' class="material-icons align-middle fold">{{ icons.add }}</i></button></th>
          </tr>
        </thead>
        <tbody v-for='(tool, index) in tools'>
          <tr>
            <td headers='managing-tools-name'>
              <div class="form-group mt-0">
                <input type="text" class="form-control" :name="'tools[' + index + '][name]'" v-model='tool.name'>
              </div>
            </td>
            <td headers='managing-tools-version'>
              <div class="form-group mt-0">
                <input type="text" class="form-control" :name="'tools[' + index + '][version]'" v-model='tool.version'>
              </div>
            </td>
            <td headers='managing-tools-btn' class='align-middle'>
              <button type='button' class='btn btn-sm btn-secondary' v-on:click='removeTool(index)'>
                <i aria-hidden='true' class="material-icons align-middle fold">{{ icons.delete }}</i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</template>
<script>
  export default {
    el: '#managing_tools',
    data: function() {
      let element = document.getElementById('managing_tools');
      let tools = []
      if (element != null) {
        tools = element.dataset.tools ? JSON.parse(element.dataset.tools) : []
      }
      let i18n = {
        tools: {
          category: element.dataset.i18nToolsCategory,
          name: element.dataset.i18nToolsName,
          version: element.dataset.i18nToolsVersion
        }
      }
      let icons = {
        add: element.dataset.iconsAdd,
        delete: element.dataset.iconsDelete
      }
      return { tools: tools, icons: icons, i18n: i18n }
    },
    methods: {
      addTool: function() {
        this.tools.push({
          name: null,
          version: null
        });
      },
      removeTool: function(index) {
        this.tools.splice(index, 1);
      }
    }
  }
</script>
