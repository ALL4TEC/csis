class AddExploitSourceData < ActiveRecord::Migration[7.0]
  def change
    add_column :exploit_sources, :id_format, :string
    add_column :exploit_sources, :exploits_root_url, :string

    # Update existing exploit sources
    ExploitSource.find_or_create_by(name: 'The Exploit-DB') do
      id_format = 'EDB-ID'
      exploits_root_url = 'https://www.exploit-db.com/exploits/'
    end
    ExploitSource.find_or_create_by(name: 'O Day Today') do
      id_format = '0DT-ID'
      exploits_root_url = 'https://0day.today/exploit/description/'
    end
    ExploitSource.find_or_create_by(name: 'PacketStorm') do
      id_format = 'PACKETSTORM'
      exploits_root_url = 'https://packetstormsecurity.com/files/'
    end
    ExploitSource.find_or_create_by(name: 'Seebug') do
      id_format = 'SSV'
      exploits_root_url = 'https://www.seebug.org/vuldb/'
    end
    ExploitSource.find_or_create_by(name: 'Core Security') do
      exploits_root_url = 'https://www.coresecurity.com/core-labs/exploits'
    end
    ExploitSource.find_or_create_by(name: 'Metasploit') do
      id_format = 'MSF'
      exploits_root_url = 'https://www.rapid7.com/db/?q=&type=metasploit'
    end
    ExploitSource.find_or_create_by(name: 'Saint Corporation') do
      id_format = 'SAINT'
      exploits_root_url = 'http://www.saintcorporation.com/'
    end
    ExploitSource.find_or_create_by(name: 'FOISted') do
      id_format = 'FOISted'
      exploits_root_url = 'https://github.com/MarginResearch/FOISted'
    end
  end
end
