class UpdateVulnerabilityFromQualysApi < ActiveRecord::Migration[5.2]
  def change
    remove_column :vulnerabilities, :sub_category
    remove_column :vulnerabilities, :vendor_reference
    remove_column :vulnerabilities, :cvss_base
    remove_column :vulnerabilities, :cvss3_base
    remove_column :vulnerabilities, :severity
    remove_column :vulnerabilities, :description_fr
    change_column :vulnerabilities, :bugtraq_id, "varchar[] USING (string_to_array(bugtraq_id, ','))"
    add_column :vulnerabilities, :solution, :text
    add_column :vulnerabilities, :diagnosis, :text
    add_column :vulnerabilities, :vuln_type, :string
    add_column :vulnerabilities, :severity, :integer
    add_column :vulnerabilities, :patchable, :integer
    add_column :vulnerabilities, :consequence, :text
    add_column :vulnerabilities, :pci_flag, :integer
    add_column :vulnerabilities, :remote, :integer
    add_column :vulnerabilities, :additional_info, :text
    add_column :vulnerabilities, :diagnosis_fr, :text
  end
end
