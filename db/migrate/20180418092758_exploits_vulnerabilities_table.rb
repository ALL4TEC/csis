class ExploitsVulnerabilitiesTable < ActiveRecord::Migration[5.2]
  def change
    create_table :exploits_vulnerabilities, id: false do |t|
      t.uuid :exploit_id, null: false
      t.uuid :vulnerability_id, null: false
    end
    add_foreign_key :exploits_vulnerabilities, :exploits, column: :exploit_id, primary_key: :id, on_delete: :cascade
    add_foreign_key :exploits_vulnerabilities, :vulnerabilities, column: :vulnerability_id, primary_key: :id, on_delete: :cascade

    add_index :exploits_vulnerabilities, [:exploit_id, :vulnerability_id], unique: true, name: 'index_exploits_vuln_on_exploit_id_and_vuln_id'
  end
end
